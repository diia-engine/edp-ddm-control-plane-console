{{ template "layout.html" . }}

{{ define "content" }}
    <div class="registry registry-create">
        <div class="registry-header">
            <a href="{{ .BasePath }}/admin/registry/overview" class="registry-add">
                <img alt="add registry" src="{{ .BasePath }}/static/img/action-back.png" />
                <span>НАЗАД</span>
            </a>
        </div>
        <h1>Створити новий реєстр</h1>
        <div class="registry-description">Щоб створити реєстр, вкажіть його назву та додайте опис.</div>

        <form class="registry-create-form" method="post" action="">
            {{ if .error }}
            <div class="rc-global-error">{{.error}}</div>
            {{ end }}

            <input type="hidden" name="_xsrf" value="{{ .xsrfdata }}" />
            <div class="rc-title">
                Увага! Назва повинна бути унікальною і її неможливо буде змінити після створення реєстру!
            </div>
            <div class="rc-form-group {{ if .errorsMap.Name }}error{{end}}">
                <label for="name">Назва реєстру</label>
                <input type="text" id="name" name="name" maxlength="12" required pattern="^[a-z0-9]([-a-z0-9]*[a-z0-9])?([a-z0-9]([-a-z0-9]*[a-z0-9])?)*$"
                       value="{{.model.Name}}" />
                <span>
                    {{range $key, $val := .errorsMap.Name}}
                        {{i18n "uk" $val.Error}}
                    {{end}}
                </span>
                <p>Допустимі символи: "a-z", "-". Назва не може перевищувати довжину у 12 символів.</p>
            </div>
            <div class="rc-form-group {{ if .errorsMap.Admins }}error{{end}}">
                <label for="admins">Адміністратори</label>
                <input type="text" id="admins" name="admins" pattern="^[a-zA-Z0-9@._-,]+$"
                       value="{{.model.Admins}}" />
                <span>
                    {{range $key, $val := .errorsMap.Admins}}
                        {{i18n "uk" $val.Error}}
                    {{end}}
                </span>
                <p>Допустимі символи: "0-9", "a-z", "_", "-", "@", ".", ",".</p>
            </div>
            <div class="rc-form-group {{ if .errorsMap.Description }}error{{end}}">
                <label for="description">Опис</label>
                <textarea rows="3" name="description" id="description" maxlength="250">{{.model.Description}}</textarea>
                <span>{{range $key, $val := .errorsMap.Description}}{{ $val }}{{end}}</span>
                <p>Опис може містити офіційну назву реєстру чи його призначення.</p>
            </div>
            <div class="rc-form-group {{ if .errorsMap.Key6 }}error{{end}}">
                <label for="key6">Key-6.dat (обов'язково у форматі base64)</label>
                <textarea rows="3" name="key6" id="key6">{{.model.Key6}}</textarea>
                <span>
                    {{range $key, $val := .errorsMap.Key6}}
                        {{i18n "uk" $val.Error}}
                    {{end}}
                </span>
            </div>
            <div class="rc-form-group {{ if .errorsMap.SignKeyIssuer }}error{{end}}">
                <label for="sign-key-issuer">digital-signature-key-issuer</label>
                <input type="text" id="sign-key-issuer" name="sign-key-issuer" value="{{.model.SignKeyIssuer}}" />
                <span>
                    {{range $key, $val := .errorsMap.SignKeyIssuer}}
                        {{i18n "uk" $val.Error}}
                    {{end}}
                </span>
            </div>
            <div class="rc-form-group {{ if .errorsMap.SignKeyPwd }}error{{end}}">
                <label for="sign-key-pwd">digital-signature-key-password</label>
                <input type="text" id="sign-key-pwd" name="sign-key-pwd" value="{{.model.SignKeyPwd}}" />
                <span>
                    {{range $key, $val := .errorsMap.SignKeyPwd}}
                        {{i18n "uk" $val.Error}}
                    {{end}}
                </span>
            </div>
            <div class="rc-form-group {{ if .errorsMap.CACertificate }}error{{end}}">
                <label for="ca-cert">CACertificates.p7b (обов'язково у форматі base64)</label>
                <textarea rows="3" name="ca-cert" id="ca-cert">{{.model.CACertificate}}</textarea>
                <span>
                    {{range $key, $val := .errorsMap.CACertificate}}
                        {{i18n "uk" $val.Error}}
                    {{end}}
                </span>
            </div>
            <div class="rc-form-group {{ if .errorsMap.CAsJSON }}error{{end}}">
                <label for="ca-json">CAs.json (обов'язково у форматі base64)</label>
                <textarea rows="3" name="ca-json" id="ca-json">{{.model.CAsJSON}}</textarea>
                <span>
                    {{range $key, $val := .errorsMap.CAsJSON}}
                        {{i18n "uk" $val.Error}}
                    {{end}}
                </span>
            </div>
            <div class="rc-form-group">
                <button type="submit" name="submit">Підтвердити</button>
            </div>
        </form>
    </div>


{{ end }}

{{ define "js"}}
    <script type="text/javascript">
        $(function (){
            $("#name").on('change invalid', function(){
                let input = $(this).get(0);
                input.setCustomValidity('');

                if (!input.validity.valid) {
                    input.setCustomValidity('Будь-ласка вкажіть назву у відповідному форматі');
                }
            });
        });
    </script>
{{end}}